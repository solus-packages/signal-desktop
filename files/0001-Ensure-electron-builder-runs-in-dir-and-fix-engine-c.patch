From b80a13c00f74003d841c9c3d044be6e47c6c80fd Mon Sep 17 00:00:00 2001
From: Joshua Strobl <joshua@streambits.io>
Date: Wed, 23 Dec 2020 19:32:28 +0200
Subject: [PATCH 1/1] Ensure electrion-builder runs in dir and fix engien check
 to do a minimum for our nodejs.

---
 package.json | 17 ++---------------
 1 file changed, 2 insertions(+), 15 deletions(-)

diff --git a/package.json b/package.json
index d2a12343..6a5164eb 100644
--- a/package.json
+++ b/package.json
@@ -52,7 +52,7 @@
     "build:typed-scss": "tsm sticker-creator",
     "build:webpack": "cross-env NODE_ENV=production webpack",
     "build:electron": "electron-builder --config.extraMetadata.environment=$SIGNAL_ENV",
-    "build:release": "cross-env SIGNAL_ENV=production npm run build:electron -- --config.directories.output=release",
+    "build:release": "electron-builder -- --config.extraMetadata.environment=$SIGNAL_ENV --dir",
     "build:zip": "node scripts/zip-macos-release.js",
     "preverify:ts": "yarn build:typed-scss",
     "verify": "run-p --print-label verify:*",
@@ -264,9 +264,6 @@
   "resolutions": {
     "@storybook/react/@storybook/core/node-fetch": "2.6.1"
   },
-  "engines": {
-    "node": "12.13.0"
-  },
   "build": {
     "appId": "org.whispersystems.signal-desktop",
     "mac": {
@@ -329,20 +326,10 @@
         "node_modules/zkgroup/libzkgroup.*"
       ],
       "target": [
-        "deb"
+        "dir"
       ],
       "icon": "build/icons/png"
     },
-    "deb": {
-      "depends": [
-        "libnotify4",
-        "libappindicator1",
-        "libxtst6",
-        "libnss3",
-        "libasound2",
-        "libxss1"
-      ]
-    },
     "protocols": {
       "name": "sgnl-url-scheme",
       "schemes": [
-- 
2.29.2

